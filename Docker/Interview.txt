1. Explain Docker Namespaces

Docker uses Linux namespaces to provide process-level isolation. Each container gets its own namespace so it feels like a separate machine even though it shares the same kernel. Namespaces isolate what a container can see.

Types of namespaces Docker uses
| Namespace | What it isolates          | Example                                      |
| --------- | ------------------------- | -------------------------------------------- |
| **PID**   | Process tree              | Container sees only its own processes        |
| **NET**   | Networking stack          | Each container gets its own veth, IP         |
| **IPC**   | Shared memory, semaphores | Prevents shared memory clashes               |
| **UTS**   | Hostname & domain name    | Container has its own hostname               |
| **MNT**   | Filesystem mount points   | Containers get their own root FS             |
| **USER**  | UID/GID mapping           | Map root inside container â†’ non-root outside |

2. What is cgroups and how does Docker use them?

cgroups (control groups) are a Linux kernel feature that Docker uses to limit and manage system resources such as CPU, memory, IO, and PIDs for each container.

What Docker controls with cgroups:
CPU throttling (--cpus, --cpu-shares)
Memory limits & OOM protection (-m, --memory-swap)
Block IO (--blkio-weight)
PIDs (--pids-limit)

âœ… 3. What is a Union Filesystem in Docker?

UnionFS is a filesystem technology that allows Docker to create images in layers. Each layer is read-only, and containers get a thin writable layer on top.

Why UnionFS is powerful:

Avoids duplication â†’ saves space
Enables image layer caching
Faster builds â†’ unchanged layers are reused
Basis of all Docker images

âœ… 4. What is the purpose of overlay2?

overlay2 is Dockerâ€™s default and most efficient storage driver.
It's an improved OverlayFS that merges multiple read-only image layers into one unified view and provides a very fast writable layer for containers. Overlay2 is Dockerâ€™s default and recommended storage driver on modern Linux kernels (4.x+). It is an implementation of OverlayFS, which merges multiple image layers into a single unified filesystem.

Why overlay2 is preferred:

âœ” Faster image builds
âœ” Better disk usage
âœ” Less inode consumption
âœ” More stable for large layers
âœ” Works extremely well with modern kernels (4.x+)

âœ” Faster builds
Uses minimal copy operations.

âœ” Space-efficient
No duplication of layers.

âœ” Better for large images
Efficient merging of many layers.

âœ” Stable for production
Recommended by Docker & Kubernetes.

overlay2 supports up to 128 lower layers (more than aufs).
It uses copy-on-write, which saves space and avoids copying entire files.
Works best when the host filesystem is XFS with ftype=1 or ext4.
Reduces inode consumption compared to old drivers â€” but can still run out in high-churn deployments.

docker system df   Check Docker disk usage
df -i   Check host inode usage

ðŸ§ª 18. What happens when Docker stops a container?

Stopping follows a signal sequence:

Docker sends SIGTERM to PID 1
â†’ gives the app time to gracefully shut down
â†’ default timeout = 10 seconds

If still running, Docker forces kill using SIGKILL
â†’ immediate termination
â†’ no cleanup

Container transitions to Stopped state
Resources like CPU/memory/network namespace are released.

Important:
Well-written production apps catch SIGTERM and exit cleanly.

ðŸ§ª 19. Explain OOMKill in containers.
Answer

OOMKill = Out-of-Memory Kill
Occurs when container exceeds its memory limit.

cgroup detects memory violation
Kernel kills the container's main process
You see:

OOMKilled = true
ExitCode = 137

Common causes:

Memory leak
Wrong JVM heap sizing
Large Python objects
No swap or too low memory limit

ðŸ§ª 21. What is the difference between SIGTERM and SIGKILL inside Docker?

Signal	Meaning	Behavior
SIGTERM (15)	"Please exit"	Graceful shutdown, allows cleanup
SIGKILL (9)	"Die now"	Immediate kill, no cleanup, cannot be trapped

Docker workflow:

docker stop â†’ sends SIGTERM
Waits 10 sec (configurable)

If still running â†’ sends SIGKILL
